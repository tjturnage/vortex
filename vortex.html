<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        td {
            border: 0.1em solid #000;
            width: 60px;
            height: 30px;
            text-align: center;
        }
    </style>


    <title>test</title>
</head>

<body>
    <div class="container">
        <section>
            <canvas id="c" width="600" height="600"></canvas>
        </section>
        <table id="sudoku" border="2">
            <tbody>
                <tr>
                    <td id="t11" class="r1 c1 s1 bl bt"></td>
                    <td id="t12" class="r1 c2 s1 bt"></td>
                    <td id="t13" class="r1 c3 s1 bt"></td>
                    <td id="t14" class="r1 c4 s2 bl bt"></td>
                    <td id="t15" class="r1 c5 s2 bt"></td>
                    <td id="t16" class="r1 c6 s2 bt"></td>
                    <td id="t17" class="r1 c7 s3 bl bt"></td>
                    <td id="t18" class="r1 c8 s3 bt"></td>
                    <td id="t19" class="r1 c9 s3 bt br"></td>
                </tr>
                <tr>
                    <td id="t21" class="r2 c1 s1 bl"></td>
                    <td id="t22" class="r2 c2 s1"></td>
                    <td id="t23" class="r2 c3 s1"></td>
                    <td id="t24" class="r2 c4 s2 bl"></td>
                    <td id="t25" class="r2 c5 s2"></td>
                    <td id="t26" class="r2 c6 s2"></td>
                    <td id="t27" class="r2 c7 s3 bl"></td>
                    <td id="t28" class="r2 c8 s3"></td>
                    <td id="t29" class="r2 c9 s3 br"></td>
                </tr>
                <tr>
                    <td id="t31" class="r3 c1 s1 bl"></td>
                    <td id="t32" class="r3 c2 s1"></td>
                    <td id="t33" class="r3 c3 s1"></td>
                    <td id="t34" class="r3 c4 s2 bl"></td>
                    <td id="t35" class="r3 c5 s2"></td>
                    <td id="t36" class="r3 c6 s2"></td>
                    <td id="t37" class="r3 c7 s3 bl"></td>
                    <td id="t38" class="r3 c8 s3"></td>
                    <td id="t39" class="r3 c9 s3 br"></td>
                </tr>
                <tr>
                    <td id="t41" class="r4 c1 s4 bl bt"></td>
                    <td id="t42" class="r4 c2 s4 bt"></td>
                    <td id="t43" class="r4 c3 s4 bt"></td>
                    <td id="t44" class="r4 c4 s5 bl bt"></td>
                    <td id="t45" class="r4 c5 s5 bt"></td>
                    <td id="t46" class="r4 c6 s5 bt"></td>
                    <td id="t47" class="r4 c7 s6 bl bt"></td>
                    <td id="t48" class="r4 c8 s6 bt"></td>
                    <td id="t49" class="r4 c9 s6 bt br"></td>
                </tr>
                <tr>
                    <td id="t51" class="r5 c1 s4 bl"></td>
                    <td id="t52" class="r5 c2 s4"></td>
                    <td id="t53" class="r5 c3 s4"></td>
                    <td id="t54" class="r5 c4 s5 bl"></td>
                    <td id="t55" class="r5 c5 s5"></td>
                    <td id="t56" class="r5 c6 s5"></td>
                    <td id="t57" class="r5 c7 s6 bl"></td>
                    <td id="t58" class="r5 c8 s6"></td>
                    <td id="t59" class="r5 c9 s6 br"></td>
                </tr>
                <tr>
                    <td id="t61" class="r6 c1 s4 bl"></td>
                    <td id="t62" class="r6 c2 s4"></td>
                    <td id="t63" class="r6 c3 s4"></td>
                    <td id="t64" class="r6 c4 s5 bl"></td>
                    <td id="t65" class="r6 c5 s5"></td>
                    <td id="t66" class="r6 c6 s5"></td>
                    <td id="t67" class="r6 c7 s6 bl"></td>
                    <td id="t68" class="r6 c8 s6"></td>
                    <td id="t69" class="r6 c9 s6 br"></td>
                </tr>
                <tr>
                    <td id="t71" class="r7 c1 s7 bl bt"></td>
                    <td id="t72" class="r7 c2 s7 bt"></td>
                    <td id="t73" class="r7 c3 s7 bt"></td>
                    <td id="t74" class="r7 c4 s8 bl bt"></td>
                    <td id="t75" class="r7 c5 s8 bt"></td>
                    <td id="t76" class="r7 c6 s8 bt"></td>
                    <td id="t77" class="r7 c7 s9 bl bt"></td>
                    <td id="t78" class="r7 c8 s9 bt"></td>
                    <td id="t79" class="r7 c9 s9 bt br"></td>
                </tr>
                <tr>
                    <td id="t81" class="r8 c1 s7 bl"></td>
                    <td id="t82" class="r8 c2 s7"></td>
                    <td id="t83" class="r8 c3 s7"></td>
                    <td id="t84" class="r8 c4 s8 bl"></td>
                    <td id="t85" class="r8 c5 s8"></td>
                    <td id="t86" class="r8 c6 s8"></td>
                    <td id="t87" class="r8 c7 s9 bl"></td>
                    <td id="t88" class="r8 c8 s9"></td>
                    <td id="t89" class="r8 c9 s9 br"></td>
                </tr>
                <tr>
                    <td id="t91" class="r9 c1 s7 bl bb"></td>
                    <td id="t92" class="r9 c2 s7 bb"></td>
                    <td id="t93" class="r9 c3 s7 bb"></td>
                    <td id="t94" class="r9 c4 s8 bl bb"></td>
                    <td id="t95" class="r9 c5 s8 bb"></td>
                    <td id="t96" class="r9 c6 s8 bb"></td>
                    <td id="t97" class="r9 c7 s9 bl bb"></td>
                    <td id="t98" class="r9 c8 s9 bb"></td>
                    <td id="t99" class="r9 c9 s9 br bb"></td>
                </tr>
            </tbody>
        </table>
    </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
    </script>
    <script>


function create_graph(conv, trans) {
           ctx = document.getElementById("c").getContext("2d");
           ctx.clearRect(0, 0, 600, 600);
           ctx.beginPath();
            for (var i = 0; i < 900; i += 25) {
                for (var j = 0; j < 900; j += 25) {
                    rotation(ctx, i, j, conv, trans);
                }
            }
            ctx.stroke();

        }


        function rotation(context, x, y, conv, trans) {

            const r_max = 200;
            var headlen = 3;
            var dx = 300 - x;
            var dy = 300 - y;
            var angle = Math.atan2(dy, dx);
            var sina = Math.sin(angle)
            var cosa = Math.cos(angle)
            var distance = Math.sqrt(dx ** 2 + dy ** 2);
            let inner_r_coef = distance / r_max;
            let outer_r_coef = (r_max / distance) ** 2;
            var unit = 10;


            if (distance < r_max) {
                var coef = inner_r_coef;
            } else {
                var coef = outer_r_coef;
            }

            //var conv = 5;
            //var trans = 0;
            var fmx = x + unit * coef * sina;
            var tox = x - unit * coef * sina + trans;
            var fmy = y - unit * coef * cosa;
            var toy = y + unit * coef * cosa;

            fmx = fmx - conv * coef * cosa;
            tox = tox + conv * coef * cosa;
            fmy = fmy - conv * coef * sina;
            toy = toy + conv * coef * sina;

            // new_angle is orientatin of vector instead of position from origin
            var new_angle = Math.atan2(toy - fmy, tox - fmx)

            context.moveTo(fmx, fmy);
            context.lineTo(tox, toy);
            context.moveTo(tox, toy);
            context.lineTo(tox - headlen * Math.cos(new_angle - Math.PI / 6), toy - headlen * Math.sin(new_angle - Math
                .PI / 6));
            context.moveTo(tox, toy);
            context.lineTo(tox - headlen * Math.cos(new_angle + Math.PI / 6), toy - headlen * Math.sin(new_angle + Math
                .PI / 6));
        }
            const squares = document.querySelectorAll("td");

            function get_values(id) {

                var trans = parseFloat(id.slice(1, 2)) * 2;
                var conv = parseFloat(id.slice(2, 3)) * 2;
                console.log(conv,trans);
                create_graph(conv, trans);

            };


            squares.forEach(square => {
                square.addEventListener('mouseenter', e => {
                    //getImage(e);
                    get_values(e.target.id);
                })
            });

//            squares.forEach(square => {
//                square.addEventListener('mouseleave', e => {
//                    //getImage(e);
//                    get_values(e.target.id);
//                })
//            });



    </script>
</body>

</html>